/**
 * blog-web - v2.0.0-SNAPSHOT
 * https://github.com/shree-venkat
 */
allPostsMvcViewModel.apiClient=function(a){var b=function(b,c,d,e,f,g){var h=a+"/GetAllPosts/"+b+"?category="+c+"&tag="+d+"&cur="+e+"&archive="+f+"&searchTerm="+g;return $.ajax({url:h,type:"GET",dataType:"json",async:!0})},c=function(a){return $.ajax({url:a,type:"GET",dataType:"json",async:!0})};return{getAllPosts:b,invoke:c}}(allPostsMvcViewModel.AllPostsApiEndpoint);var BlogViewModel=function(a,b){var c=this;c.Posts=window.ko.observableArray([]),c.TotalNumberOfPosts=window.ko.observable(-1),c.NumberOfPostsInCurrentPage=window.ko.observable(-1),c.UrlSlug=window.ko.observable(""),c.Category=window.ko.observable(""),c.Tag=window.ko.observable(""),c.Archive=window.ko.observable(""),c.SearchTerm=window.ko.observable(""),c.CurrPage=window.ko.observable(""),c.PrevPageUrl=window.ko.observable(""),c.NextPageUrl=window.ko.observable(""),c.LoadPosts=function(){var b=utils.getQsValue("category");b=b?b:"";var d=utils.getQsValue("tag");d=d?d:"";var e=utils.getQsValue("archive");e=e?e:"";var f=utils.getQsValue("searchTerm");f=f?f:"",a.getAllPosts("",b,d,0,e,f).done(function(a){c.ProcessResult(a)}).error(function(a){console.log(a)})},c.UpdatePosts=function(b){a.invoke(b).done(function(a){c.ProcessResult(a)}).error(function(){alert("An error occured while retrieving posts. Please try again alater.","Error")})},c.ProcessResult=function(a){if(a.UrlSlug=a.UrlSlug?a.UrlSlug:"",a.Category=a.Category?a.Category:"",a.Tag=a.Tag?a.Tag:"",a.Archive=a.Archive?a.Archive:"",a.SearchTerm=a.SearchTerm?a.SearchTerm:"",a.CurrPage=a.CurrPage?a.CurrPage:"",a.Category?$("#blog-menu-categories ul li").each(function(b){var c=$(this).find("a").first().html();c&&c.toLowerCase()==a.Category.toLowerCase()?($(this).find("a").first().addClass("highlight"),$("#blog-menu-categories button").html('<span class="button-text">'+c+'</span> <span class="caret-holder"> <span class="caret"></span> </span>')):$(this).find("a").first().removeClass("highlight")}):$("#blog-menu-categories ul li").each(function(a){var b=$(this).find("a").first().html();"All Categories"==b?($(this).find("a").first().addClass("highlight"),$("#blog-menu-categories button").html('<span class="button-text">'+b+'</span> <span class="caret-holder"> <span class="caret"></span> </span>')):$(this).find("a").first().removeClass("highlight")}),$("#blog-menu-tags .tag-link-contents a").each(function(b){var c=$(this).html();c&&c.toLowerCase()==a.Tag.toLowerCase()?$(this).addClass("selected"):$(this).removeClass("selected")}),a.SearchTerm){$("input[name='searchTerm']").val(a.SearchTerm);var d='<div class="search-button input-group-addon close-search"><i class="fa fa-times"></i></div>';$(d).insertAfter("input[name='searchTerm']"),$(".close-search").click(function(a){$("input[name='searchTerm']").val(""),$("form").submit()})}var e=Enumerable.From(a.AllPosts).Select(function(d){var e=Enumerable.From(d.Tags).Select(function(d){return d={Parent:c,Id:d.Id,Name:d.Name,UrlSlug:d.UrlSlug,Description:d.Description,Class:d.Class,TagHref:b+"Home/AllPosts/"+d.UrlSlug+"?tag="+d.Name+"&category="+a.Category,SelectTag:function(){var a=this.TagHref.replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)},SelectedTagHref:b+"Home/AllPosts?category="+a.Category,DeselectTag:function(){var a=this.SelectedTagHref.replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)}}}).OrderBy(function(a){return a.Name}).ToArray(),f=d.PostedOn.toString().replace("T"," "),g=$.datepicker.formatDate("DD, MM dd, yy",$.datepicker.parseDate("yy-mm-dd",f)),h="";if(null!=d.ModifiedOn)var i=d.ModifiedOn.toString().replace("T"," "),h=$.datepicker.formatDate("MM dd, yy",$.datepicker.parseDate("yy-mm-dd",i));return d={Parent:c,Id:d.Id,Title:d.Title,ShortDescription:d.ShortDescription,ShorterDescription:d.ShortDescription.substring(0,150),UrlSlug:d.UrlSlug,Published:d.Published,PostedOn:g,ModifiedOn:h,Category:{Id:d.Category.Id,Name:d.Category.Name,UrlSlug:d.Category.UrlSlug,Description:d.Category.Description},Tags:window.ko.observableArray(e),PostHref:b+"Blog/"+d.Id+"/"+d.UrlSlug+"?category="+a.Category+"&tag="+a.Tag+"&cur="+a.CurrPage+"&searchTerm="+a.SearchTerm,CategoryHref:b+"Home/AllPosts/"+d.Category.UrlSlug+"?category="+d.Category.Name+"&tag="+a.Tag,SelectCategory:function(){var a=this.CategoryHref.replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)},SelectedCategoryHref:b+"Home/AllPosts?tag="+a.Tag,DeselectCategory:function(){var a=this.SelectedCategoryHref.replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)}}}).ToArray();c.Posts(e),c.TotalNumberOfPosts(a.TotalCount),c.NumberOfPostsInCurrentPage(e.length),c.UrlSlug(a.UrlSlug),c.Category(a.Category),c.Tag(a.Tag),c.Archive(a.Archive),c.SearchTerm(a.SearchTerm),c.CurrPage(a.CurrPage),a.PrevPage||0===a.PrevPage?c.PrevPageUrl(b+"Home/AllPosts/"+a.UrlSlug+"?category="+a.Category+"&tag="+a.Tag+"&cur="+a.PrevPage+"&searchTerm="+a.SearchTerm):c.PrevPageUrl(""),a.NextPage?c.NextPageUrl(b+"Home/AllPosts/"+a.UrlSlug+"?category="+a.Category+"&tag="+a.Tag+"&cur="+a.NextPage+"&searchTerm="+a.SearchTerm):c.NextPageUrl(""),window.scrollTo(0,0)},c.GoToPrevPage=function(){var a=c.PrevPageUrl().replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)},c.GoToNextPage=function(){var a=c.NextPageUrl().replace("Home/AllPosts","api/GetAllPosts");c.UpdatePosts(a)}};!function(){"use strict";var a=new BlogViewModel(allPostsMvcViewModel.apiClient,allPostsMvcViewModel.RootUrl);$.when(a.LoadPosts()).done(function(){setTimeout(function(){ko.applyBindings(a,document.getElementById("all-posts-section"))},500),setTimeout(function(){},1e3)})}();